<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Document</title>
</head>
<body>
 <canvas id="meuCanvas" width="400" height="300" style="border:5px solid black"></canvas>
 
 <script>
        const canvas = document.getElementById('meuCanvas')
        const ctx = canvas.getContext('2d')

        //variaveis
        //bolinhas
        let x = canvas.width / 2 //começa no meio da tela
        let y = canvas.height - 30 //começa perto da parte de baixo
        let dx = 3 //velocidade horizontal
        let dy = -3 //velocidade vertical
        const raio = 10 //raio da bolinha

        //raquete
        const raqueteAltura = 10 //altura da raquete
        const raqueteLargura = 75 //largura da raquete
        let raqueteX = (canvas.width - raqueteLargura) / 2 //posição x da raquete (horizontal)

        //controle
        let teclaDireita = false //vira true qd aperta
        let teclaEsquerda = false //vira true qd aperta

        //eventos do teclado
        document.addEventListener("keydown", function(e){
            if (e.key === "ArrowRight" || e.key === "Right") { // aceita os dois
                teclaDireita = true
            } else if (e.key === "ArrowLeft" || e.key === "Left") { // aceita os dois
                teclaEsquerda = true
            }
        })
        //quando soltar a tecla ele para
        document.addEventListener("keyup", function(e){
             if (e.key === "ArrowRight" || e.key === "Right") {
                teclaDireita = false
            } else if (e.key === "ArrowLeft" || e.key === "Left") {
                teclaEsquerda = false
            }
        })

        //desenhos
        //bolinha
        function desenharBola(){
            ctx.beginPath() //iniciando
            ctx.arc(x,y,raio,0,Math.PI*2) //tamanho 
            ctx.fillStyle = "purple" //definindo a cor
            ctx.fill() //pintando
            ctx.closePath() //terminando o desenho
        }

        //raquete
        function desenharRaquete (){
            ctx.beginPath()
            ctx.rect(raqueteX, canvas.height - raqueteAltura - 5, raqueteLargura, raqueteAltura)
            ctx.fillStyle = "black"
            ctx.fill()
            ctx.closePath()
        }

        //animação
        function desenhar(){
            //parte 1: Limpar o canvas
            ctx.clearRect(0,0, canvas.width, canvas.height)

            //parte 2: desenhar os elementos
            desenharBola()
            desenharRaquete()

            //parte 3: Atualizo a posição da bolinha usando a velocidade
            x += dx
            y += dy

            //parte 4: verificar colisões horizontais
            if (x + dx > canvas.width - raio || x + dx < raio) {
                dx = -dx
            } 

            //parte 5: verificar colisões verticais
            if (y + dy < raio){
                dy = -dy
            } 
            //parte 6:verificar colisão com a parte de baixo (raquete e fundo)
            else if (y + dy > canvas.height - raio) {
                //se a bolinha estiver dentro da área da raquete, vai rebater
                if (x > raqueteX && x < raqueteX + raqueteLargura) {
                    dy = -dy
                } else{
                    alert("Game Over!")
                    document.location.reload() //reinicia o jogo
                    return
                }
            }

            //parte 7: movimentar a raquete com as setas 
            //verificar limite da tela
            if (teclaDireita && raqueteX < canvas.width - raqueteLargura) {
                raqueteX += 7
            } else if (teclaEsquerda && raqueteX > 0) {
                raqueteX -= 7
            }

            //parte 8: rodar no navegador
            requestAnimationFrame(desenhar)
        }
        //inicia a animação
        desenhar()
 </script>
</body>
</html>
